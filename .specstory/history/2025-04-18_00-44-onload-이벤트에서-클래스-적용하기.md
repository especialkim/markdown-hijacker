<!-- Generated by SpecStory -->

# onload 이벤트에서 클래스 적용하기 (2025-04-18 09:44:28)

_**User**_

나는 리빌딩하고 있어. 여기 onload에 이거 class적용된 div 출력해서 설정창 보고 싶으면 어떻게 하나

---

_**Assistant**_



---

먼저 Markdown Hijacker 플러그인의 현재 구조를 살펴보겠습니다.

---

<details>
            <summary>Searched codebase "main.ts class MarkdownHijacker" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `main.ts` | L485-493 |
| `main.ts` | L414-425 |
| `main.ts` | L493-527 |
| `main.ts` | L165-173 |
| `main.ts` | L225-233 |
| `main.ts` | L284-294 |
| `main.ts` | L233-239 |
| `main.ts` | L200-214 |
| `main.ts` | L239-246 |
| `main.ts` | L294-303 |
| `main.ts` | L630-645 |
| `main.ts` | L214-225 |
| `main.ts` | L303-319 |
| `main.ts` | L356-403 |
| `main.ts` | L185-200 |
| `main.ts` | L403-414 |
| `main.ts` | L180-185 |
| `main.ts` | L246-254 |
| `main.ts` | L173-180 |
| `settings.ts` | L45-54 |
| `main.ts` | L425-449 |
| `main.ts` | L541-567 |
| `main.ts` | L527-541 |
| `main.ts` | L567-600 |
| `main.ts` | L319-356 |

</details>

---

Read file: main.ts

---

Read file: settings/settings.ts

---

<details>
            <summary>Searched codebase "MarkdownHijackerSettings interface" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `settings/types.ts` | L19-27 |
| `settings/settings.ts` | L2-28 |
| `src/types.ts` | L14-46 |
| `settings.ts` | L12-30 |
| `main.ts` | L493-527 |
| `main.ts` | L414-425 |
| `settings.ts` | L45-54 |
| `main.ts` | L180-185 |
| `main.ts` | L173-180 |
| `Notes/02a 프로젝트 설정 및 기본 구조 구축.md` | L1-57 |
| `main.ts` | L185-200 |
| `settings.ts` | L30-45 |
| `main.ts` | L225-233 |
| `src/settings-tab.ts` | L25-51 |
| `src/types.ts` | L46-64 |
| `main.ts` | L1-41 |
| `settings.ts` | L119-139 |
| `src/settings-tab.ts` | L1-25 |
| `settings.ts` | L1-12 |
| `src/settings-tab.ts` | L51-75 |
| `settings.ts` | L586-598 |
| `settings.ts` | L478-488 |
| `main.ts` | L303-319 |
| `settings.ts` | L54-87 |
| `styles.css` | L1-63 |

</details>

---

Read file: settings.ts

---

플러그인을 리빌딩하면서 설정창을 보고 싶다면, 다음과 같이 `onload` 메소드를 수정하여 설정 UI를 표시할 수 있습니다:

---

```diff
  		console.log(dataJson);
  
- 		this.addSettingTab(new MarkdownHijackerSettingUI(this.app, this));
- 
- 		// await this.loadSettings();
- 		// console.log(`[Markdown Hijacker] 플러그인 설정 로드됨 - 외부 동기화: ${this.settings.enableExternalSync ? '예' : '아니오'}, Vault 동기화: ${this.settings.enableVaultSync ? '예' : '아니오'}, 플러그인 활성화: ${this.settings.pluginEnabled ? '예' : '아니오'}`);
- 		
- 		// // 설정 탭 추가
- 		// this.addSettingTab(new MarkdownHijackerSettingTab(this.app, this));
- 		
- 		// // 디버그 모드 설정
- 		// const debugMode = this.settings.debugMode;
- 		
- 		// // 외부 폴더 감시자 초기화
- 		// console.log('[Markdown Hijacker] 외부 폴더 감시자 초기화 중...');
- 		// this.externalWatcher = new ExternalFolderWatcher(this.app, debugMode);
- 		
- 		// // 내부 폴더 감시자 초기화
- 		// console.log('[Markdown Hijacker] 내부 Vault 감시자 초기화 중...');
- 		// this.internalWatcher = new InternalWatcher(this.app, debugMode);
- 		
- 		// // Vault 동기화 객체 초기화
- 		// console.log('[Markdown Hijacker] VaultSync 객체 초기화...');
- 		// this.vaultSync = new VaultSync(this.app);
- 		
- 		// // 외부 동기화 초기화
- 		// console.log('[Markdown Hijacker] ExternalSync 객체 초기화...');
- 		// this.externalSync = new ExternalSync(
- 		// 	this,
- 		// 	this.externalWatcher,
- 		// 	undefined,
- 		// 	debugMode
- 		// );
+ 		// 설정 UI 초기화 및 등록
+ 		const settingUI = new MarkdownHijackerSettingUI(this.app, this);
+ 		this.addSettingTab(settingUI);
+ 		
+ 		// 개발 중 테스트를 위해 설정 UI 직접 표시
+ 		const settingContainer = document.createElement('div');
+ 		settingContainer.id = 'markdown-hijacker-setting-container';
+ 		settingContainer.classList.add('markdown-hijacker-settings');
+ 		document.body.appendChild(settingContainer);
  		
- 		// // 내부 동기화 초기화 (Vault 내부 변경사항을 외부 폴더로 동기화)
- 		// console.log('[Markdown Hijacker] InternalSync 객체 초기화...');
- 		// this.internalSync = new InternalSync(
- 		// 	this.app,
- 		// 	this.internalWatcher
- 		// );
- 		
- 		// // 상태 바 아이템 설정
- 		// this.setupStatusBar();
- 		
- 		// // Register the file:open event
- 		// this.registerEvent(
- 		// 	this.app.workspace.on('file-open', (file: TFile | null) => {
- 		// 		if (!file) return;
- 
- 		// 		const filePath = file.path;
- 		// 		this.handleFileOpen(filePath);
- 		// 	})
- 		// );
- 		
- 		// // 플러그인 기능 활성화 - enableExternalSync 확인 먼저!
- 		// console.log(`[Markdown Hijacker] 외부 폴더 동기화 설정 확인 중: ${this.settings.enableExternalSync ? '활성화됨' : '비활성화됨'}`);
- 		// console.log(`[Markdown Hijacker] Vault 내부 동기화 설정 확인 중: ${this.settings.enableVaultSync ? '활성화됨' : '비활성화됨'}`);
- 		
- 		// // 플러그인이 활성화된 경우에만 모니터링 시작
- 		// if (this.settings.pluginEnabled) {
- 		// 	console.log('[Markdown Hijacker] 플러그인 활성화됨 - 모니터링 시작...');
- 		// 	this.startMonitoring();
- 		// } else {
- 		// 	console.log('[Markdown Hijacker] 플러그인 비활성화됨 - 모니터링 건너뜀');
- 		// }
- 
- 		// // 외부 폴더 동기화가 활성화된 경우에만 동기화 모니터링 시작
- 		// if (this.settings.enableExternalSync) {
- 		// 	console.log('[Markdown Hijacker] 외부 폴더 동기화 시작...');
- 		// 	this.startMonitoringExternalChanges();
- 		// } else {
- 		// 	console.log('[Markdown Hijacker] 외부 폴더 동기화가 비활성화되어 있습니다. 설정에서 활성화하세요.');
- 		// }
- 		
- 		// // Vault 내부 동기화가 활성화된 경우에만 내부 변경 감지 시작
- 		// if (this.settings.enableVaultSync) {
- 		// 	console.log('[Markdown Hijacker] Vault 내부 변경 감지 시작...');
- 		// 	this.startMonitoringInternalChanges();
- 		// } else {
- 		// 	console.log('[Markdown Hijacker] Vault 내부 동기화가 비활성화되어 있습니다. 설정에서 활성화하세요.');
- 		// }
- 		
- 		// // 설정 변경 이벤트 처리
- 		// this.registerEvent(
- 		// 	(this.app.workspace as any).on('markdown-hijacker:settings-changed', () => {
- 		// 		this.updateStatusBar();
- 				
- 		// 		// 플러그인 상태에 따라 모니터링 시작 또는 중지
- 		// 		if (this.settings.pluginEnabled) {
- 		// 			this.restartMonitoring();
- 		// 		} else {
- 		// 			this.stopMonitoring();
- 		// 		}
- 		// 	})
- 		// );
- 		
- 		// console.log('[Markdown Hijacker] 플러그인 로드 완료');
+ 		// 설정 UI 렌더링
+ 		const containerEl = settingContainer;
+ 		containerEl.empty(); // 기존 내용 제거
+ 		
+ 		// 설정 UI 표시
+ 		settingUI.display();
+ 		
+ 		// 스타일 추가
+ 		const style = document.createElement('style');
+ 		style.textContent = `
+ 			#markdown-hijacker-setting-container {
+ 				position: fixed;
+ 				top: 50px;
+ 				right: 20px;
+ 				width: 400px;
+ 				max-height: 80vh;
+ 				background-color: var(--background-primary);
+ 				border-radius: 8px;
+ 				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
+ 				z-index: 1000;
+ 				padding: 20px;
+ 				overflow-y: auto;
+ 			}
+ 		`;
+ 		document.head.appendChild(style);
  	}
  
```

---

```diff
- 
  import MarkdownHijacker from "../main";
- import { App, PluginSettingTab } from "obsidian";
+ import { App, PluginSettingTab, Setting } from "obsidian";
  
  const DEFAULT_SETTINGS = {
```

```diff
          containerEl.createEl('h2', { text: 'Markdown Hijacker 설정' });
  
-         
+         // 플러그인 활성화 토글
+         new Setting(containerEl)
+             .setName('플러그인 활성화')
+             .setDesc('플러그인을 활성화하거나 비활성화합니다.')
+             .addToggle(toggle => toggle
+                 .setValue(this.plugin.settings?.pluginEnabled || false)
+                 .onChange(async (value) => {
+                     if (!this.plugin.settings) {
+                         this.plugin.settings = {
+                             pluginEnabled: value,
+                             folderMappings: [],
+                             excludeFoldersEnabled: false,
+                             excludeFolders: "",
+                             includeFoldersEnabled: false,
+                             includeFolders: "",
+                             syncInterval: 1000,
+                             debugMode: false,
+                             enableExternalSync: false,
+                             showNotifications: true,
+                             enableVaultSync: false
+                         };
+                     } else {
+                         this.plugin.settings.pluginEnabled = value;
+                     }
+                     await this.plugin.saveSettings();
+                 }));
+ 
+         // 디버그 모드
+         new Setting(containerEl)
+             .setName('디버그 모드')
+             .setDesc('콘솔에 디버그 메시지를 출력합니다.')
+             .addToggle(toggle => toggle
+                 .setValue(this.plugin.settings?.debugMode || false)
+                 .onChange(async (value) => {
+                     if (this.plugin.settings) {
+                         this.plugin.settings.debugMode = value;
+                         await this.plugin.saveSettings();
+                     }
+                 }));
+                 
+         // 동기화 간격 설정
+         new Setting(containerEl)
+             .setName('동기화 간격')
+             .setDesc('파일 변경 확인 간격(밀리초)')
+             .addSlider(slider => slider
+                 .setLimits(500, 10000, 500)
+                 .setValue(this.plugin.settings?.syncInterval || 1000)
+                 .setDynamicTooltip()
+                 .onChange(async (value) => {
+                     if (this.plugin.settings) {
+                         this.plugin.settings.syncInterval = value;
+                         await this.plugin.saveSettings();
+                     }
+                 }))
+             .addExtraButton(button => button
+                 .setIcon('reset')
+                 .setTooltip('기본값으로 재설정')
+                 .onClick(async () => {
+                     if (this.plugin.settings) {
+                         this.plugin.settings.syncInterval = 1000;
+                         await this.plugin.saveSettings();
+                         this.display();
+                     }
+                 }));
+                 
+         // 플러그인 상태 표시
+         const statusDiv = containerEl.createDiv('plugin-status');
+         statusDiv.createEl('h3', { text: '플러그인 상태' });
+         
+         const statusText = statusDiv.createEl('p');
+         statusText.textContent = `활성화 상태: ${this.plugin.settings?.pluginEnabled ? '켜짐' : '꺼짐'}`;
+         
+         const debugText = statusDiv.createEl('p');
+         debugText.textContent = `디버그 모드: ${this.plugin.settings?.debugMode ? '켜짐' : '꺼짐'}`;
      }
  }
```

---

