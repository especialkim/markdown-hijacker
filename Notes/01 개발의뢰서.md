# Obsidian 플러그인 개발 의뢰서: 외부 폴더 ↔ Vault 폴더 양방향 실시간 동기화 플러그인

## 목적
- 외부 프로젝트 폴더 안의 `.md` 파일을 Obsidian Vault 내부 폴더와 **1:1 매칭**하여 관리
- **동일한 이름과 경로로 Vault 내부에도 파일을 생성**하고
- **양쪽 파일을 수정할 때 서로 자동 동기화**
- **충돌 감지/병합은 하지 않고**, 마지막으로 저장한 파일이 우선 적용

## 주요 기능

- 설정 화면
  - 매칭 리스트
    - [Vault 내 상대 경로] - [외부 폴더 절대 경로] 등록
    - 복수 매칭 등록 가능
  - 제외할 서브폴더 옵션
    - ON/OFF 스위치
    - ON일 경우 TextArea로 제외할 폴더명 여러 개 입력 (콤마 구분)
  - 포함할 서브폴더 옵션
    - ON/OFF 스위치
    - ON일 경우 TextArea로 포함할 폴더명 여러 개 입력 (콤마 구분)
  - 기본은 "모든 하위폴더 탐색"
    - 포함 옵션이 켜지면 지정된 서브폴더만 탐색

- 파일/폴더 매칭
  - 외부 폴더 구조와 Vault 내부 구조를 동일하게 유지
  - `.md` 파일만 동기화 대상으로 함

- 동기화 로직
  - 외부 파일 변경 시 Vault 파일에 덮어쓰기
  - Vault 파일 변경 시 외부 파일에 덮어쓰기
  - 신규 파일 생성/삭제도 감지하여 반영

- 파일 삭제 처리
  - 외부 폴더 파일 삭제(VSC 등)
    - Vault 파일은 **삭제하지 않고**
    - 파일명 앞에 **🗑️ 이모지 추가**
    - 파일 내용 맨 위 frontmatter에 `isdeleted: true` 추가 또는 수정
  - Vault 폴더 파일 수동 삭제
    - 외부 파일은 실제로 삭제

- 제외/포함 규칙
  - 제외할 서브폴더가 지정된 경우, 해당 폴더 및 하위 파일/폴더는 무시
  - 포함할 서브폴더가 지정된 경우, 해당 폴더만 탐색 및 동기화

- 성능
  - 변경 감지 후 0.5~1초 내 반영
  - 대용량 파일 처리 시에도 최소 지연

- 안정성
  - 충돌 발생 시 별도 경고 없이 마지막 저장본으로 덮어쓰기
  - 충돌 해결/병합 기능은 구현하지 않음

## 기술 스택 및 API

- Obsidian 플러그인 API
  - `app.vault.adapter`를 통한 파일 I/O
  - 플러그인 SettingsTab 사용
  - Event hook (`on('modify', 'delete', ...)`) 사용
- Node.js / Electron API
  - `fs.watch`로 외부 폴더 실시간 감시

## 기타 사항

- 최초 실행 시 외부 폴더 스캔 → Vault에 동일한 구조 생성 (없으면 자동 생성)
- 기본 File Explorer에서는 Vault 안에 생성된 파일이 바로 보임
- 가상 표시가 아니라 **실제 파일 존재**
- 검색, 링크, Graph View 모두 기본 Vault 파일처럼 정상 동작
- 삭제된 파일은 시각적으로도 구분 가능 (🗑️ 이모지)

## 예상 플로우 요약

```
1. 설정 화면에서 Vault폴더-외부폴더 매칭 추가
2. 제외/포함 서브폴더 옵션 설정
3. 플러그인 활성화 시 외부폴더 스캔
4. Vault 폴더에 파일/폴더 생성(존재하지 않으면)
5. 이후 변경사항 실시간 감시 및 동기화
6. 외부 파일 삭제 시 isdeleted: true 추가 + 파일명에 🗑️ 추가
7. 충돌 시 마지막 저장한 쪽이 덮어쓰기
```

## 주의사항

- 외부 파일을 다른 프로그램이 동시에 수정하는 경우 (ex: VSCode) 저장 타이밍에 따라 Obsidian 쪽 내용이 덮어쓸 수 있음
- 사용자가 이 위험을 수용한다는 전제 하에 개발
- 중요한 파일은 별도로 백업 권장

## 플러그인 설정 화면 구조 (대략)

```
[플러그인 활성화 스위치]

[폴더 매칭 리스트]
- Vault 경로 | 외부 경로 | [삭제버튼]
- [매칭 추가 버튼]

[제외할 서브폴더 설정]
- 제외할 서브폴더 사용 여부 (ON/OFF)
- 제외할 서브폴더 리스트 (TextArea, 콤마 구분 입력)

[포함할 서브폴더 설정]
- 포함할 서브폴더 사용 여부 (ON/OFF)
- 포함할 서브폴더 리스트 (TextArea, 콤마 구분 입력)

[변경사항 저장 버튼]
```

※ 제외/포함 옵션은 둘 다 동시에 켤 수 없음 (둘 중 하나만 활성화)