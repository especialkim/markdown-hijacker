# Markdown Hijacker 플러그인 개발계획서

## 1. 프로젝트 설정 및 기본 구조 구축 (1일)

- [x] 플러그인 프로젝트 기본 구조 생성
- [ ] 필요한 타입 정의 및 인터페이스 설계
  - `MarkdownHijackerSettings` 인터페이스 정의
  - 폴더 매칭 타입 정의 (`FolderMapping`)
- [ ] 기본 설정값 정의
- [ ] `manifest.json` 파일 업데이트
- [ ] 플러그인 클래스 기본 구조 작성

## 2. 설정 UI 구현 (2일)

- [ ] 설정 탭 클래스 생성
- [ ] 폴더 매칭 리스트 UI 구현
  - 매칭 추가 기능
  - 매칭 삭제 기능
  - Vault 경로 선택기
  - 외부 경로 선택기 (OS 파일 다이얼로그 연동)
- [ ] 제외할 서브폴더 설정 UI 구현
  - ON/OFF 스위치
  - 서브폴더 입력 TextArea
- [ ] 포함할 서브폴더 설정 UI 구현
  - ON/OFF 스위치
  - 서브폴더 입력 TextArea
- [ ] 설정 상태 저장 및 불러오기 기능 구현

## 3. 파일 시스템 모니터링 구현 (3일)

- [ ] Vault 내부 파일 변경 감지 기능 구현
  - Obsidian API 이벤트 훅 등록
  - 파일 생성/수정/삭제 이벤트 핸들러
- [ ] 외부 폴더 모니터링 기능 구현
  - Node.js `fs.watch` 활용
  - 파일 변경 감지 이벤트 핸들러
  - 방향별 변경 감지 로직 분리
- [ ] 모니터링 시작/중지 메커니즘 구현

## 4. 파일 동기화 로직 구현 (4일)

- [ ] 파일 스캔 및 초기 구조 생성 로직
  - 외부 폴더 스캔
  - 매칭되는 Vault 폴더 구조 생성
  - 초기 파일 생성/동기화
- [ ] 파일 동기화 핵심 로직 구현
  - 외부→Vault 방향 동기화
  - Vault→외부 방향 동기화
  - 파일 내용 읽기/쓰기 유틸리티
- [ ] 제외/포함 규칙 필터링 로직 구현
  - 경로 패턴 매칭
  - 필터링 유틸리티 함수

## 5. 파일 삭제 처리 구현 (2일)

- [ ] 외부 파일 삭제 감지 로직
- [ ] Vault 파일 특수 처리
  - 파일명에 🗑️ 이모지 추가
  - frontmatter에 `isdeleted: true` 추가/수정
- [ ] Vault 파일 삭제 시 외부 파일 삭제 로직
- [ ] 삭제 파일 관리 유틸리티 함수

## 6. 성능 최적화 (2일)

- [ ] 변경 감지 디바운싱 구현
  - 중복 동기화 방지
  - 연속 변경 최적화
- [ ] 대용량 파일 처리 최적화
  - 청크 단위 처리
  - 비동기 처리 최적화
- [ ] 메모리 사용량 모니터링 및 최적화
- [ ] 동시 동기화 작업 관리 메커니즘

## 7. 사용자 인터페이스 및 피드백 (2일)

- [ ] 동기화 상태 표시 UI
  - 상태 바 아이템
  - 리본 아이콘
- [ ] 오류 발생 시 알림 메커니즘
  - Notice 사용
  - 오류 로그 시스템
- [ ] 사용자 액션 명령 구현
  - 수동 동기화 명령
  - 동기화 일시 중지/재개 명령

## 8. 테스트 및 디버깅 (3일)

- [ ] 단위 테스트 작성
  - 핵심 동기화 로직 테스트
  - 설정 저장/불러오기 테스트
- [ ] 통합 테스트 시나리오
  - 다양한 폴더 구조 테스트
  - 다양한 파일 크기 테스트
  - 동시 수정 시나리오 테스트
- [ ] 엣지 케이스 테스트
  - 특수 문자 파일명
  - 매우 깊은 중첩 폴더
  - 매우 큰 파일
- [ ] 버그 수정 및 안정성 개선

## 9. 문서화 및 배포 준비 (1일)

- [ ] README 작성
  - 설치 방법
  - 사용 방법
  - 주의사항
- [ ] 코드 주석 및 문서화
- [ ] 릴리스 노트 작성
- [ ] 배포 패키징

## 10. 최종 검토 및 배포 (1일)

- [ ] 최종 기능 검토
- [ ] 성능 및 안정성 최종 점검
- [ ] GitHub 릴리스
- [ ] Obsidian 커뮤니티 플러그인 등록 준비

## 구현 우선순위 및 종속성

1. 기본 구조 및 설정 UI (1,2단계) - 다른 모든 기능의 기반
2. 파일 시스템 모니터링 (3단계) - 동기화 로직 전 필수
3. 동기화 핵심 기능 (4,5단계) - 플러그인의 핵심 기능
4. 성능 최적화 및 사용자 인터페이스 (6,7단계) - 사용성 향상
5. 테스트 및 배포 준비 (8,9,10단계) - 안정성 및 배포

## 추정 개발 기간

- 총 예상 개발 기간: 약 21일 (약 3주)
- 버퍼 기간: 1주 (예상치 못한 이슈 해결용)
- 최종 예상 완료 기간: 약 1개월

## 주요 기술적 도전 및 해결 방안

1. **파일 변경 실시간 감지 및 성능 최적화**
   - 디바운싱 및 스로틀링 적용
   - 효율적인 파일 변경 감지 알고리즘 사용

2. **양방향 동기화 시 충돌 처리**
   - 마지막 수정 시간 기반 단순 우선 적용
   - 타임스탬프 비교 로직 구현

3. **대용량 파일 및 복잡한 폴더 구조 처리**
   - 청크 단위 처리
   - 비동기 처리 및 작업 큐 시스템 구현

4. **삭제 파일 특수 처리**
   - 메타데이터 관리 시스템 구현
   - frontmatter 처리 유틸리티 개발
